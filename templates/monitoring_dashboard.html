<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring and Alerting Dashboard</title>
    <!-- Include Chart.js and your CSS file -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        #dashboard {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        h1 {
            text-align: center;
        }

        .dashboard-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            width: 100%;
            max-width: 1200px;
        }

        .form-container,
        .chart-container,
        .alerts {
            flex: 1;
            min-width: 300px;
            margin: 10px;
            padding: 20px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .form-container h2,
        .chart-container h2,
        .alerts h2 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .form-container label,
        .threshold-form label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .form-container input[type="number"],
        .threshold-form input[type="number"] {
            width: calc(100% - 24px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .form-container button[type="submit"],
        .threshold-form button[type="submit"] {
            background-color: #00d9ff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }

        .form-container button[type="submit"]:hover,
        .threshold-form button[type="submit"]:hover {
            background-color: #00a3cc;
        }

        .threshold-form span {
            margin-left: 5px;
        }

        .alerts ul {
            list-style-type: none;
            padding: 0;
        }

        .alerts li {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
        }

        .alert-cpu {
            background-color: #ffdddd;
            color: red;
        }

        .alert-ram {
            background-color: #ddddff;
            color: blue;
        }

        .alert-disk {
            background-color: #fff4e6;
            color: orange;
        }

        canvas {
            max-width: 100%;
            height: auto;
        }

        .back {
            position: absolute;
            top: 6px;
            left: 10px;
            padding: 10px 20px;
            font-size: 18px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .back:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <a class="back" href="/">Back to Previous Page</a>

    <div id="dashboard">
        <h1>Monitoring and Alerting Dashboard</h1>
        <div class="dashboard-content">
            <!-- Customizable Thresholds -->
            <div class="form-container threshold-form">
                <h2>Customizable Thresholds</h2>
                <form action="/update_thresholds" method="POST">
                    <div class="form-group">
                        <label for="cpuThreshold">CPU Threshold:</label>
                        <input type="number" id="cpuThreshold" name="cpuThreshold" min="0" max="100" value="90">
                        <span>%</span>
                    </div>
                    <div class="form-group">
                        <label for="ramThreshold">RAM Threshold:</label>
                        <input type="number" id="ramThreshold" name="ramThreshold" min="0" max="100" value="85">
                        <span>%</span>
                    </div>
                    <div class="form-group">
                        <label for="diskThreshold">Disk Threshold:</label>
                        <input type="number" id="diskThreshold" name="diskThreshold" min="0" max="100" value="75">
                        <span>%</span>
                    </div>
                    <button type="submit">Update Thresholds</button>
                </form>
            </div>

            <!-- Real-time Alerts -->
            <div class="alerts">
                <h2>Real-time Alerts</h2>
                <ul id="alertList"></ul>
            </div>

            <!-- CPU Usage Chart -->
            <div class="chart-container">
                <h2>CPU Usage</h2>
                <canvas id="cpuChart"></canvas>
            </div>

            <!-- RAM Usage Chart -->
            <div class="chart-container">
                <h2>RAM Usage</h2>
                <canvas id="ramChart"></canvas>
            </div>

            <!-- Disk Usage Chart -->
            <div class="chart-container">
                <h2>Disk Usage</h2>
                <canvas id="diskChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Include JavaScript code for real-time updates -->
    <script>
        // Chart data and options
        const chartData = {
            cpu: { data: [], labels: [], title: 'CPU Usage' },
            ram: { data: [], labels: [], title: 'RAM Usage' },
            disk: { data: [], labels: [], title: 'Disk Usage' }
        };

        const chartOptions = {
            scales: {
                x: { display: true },
                y: { beginAtZero: true, max: 100 }
            }
        };

        // Create charts
        const ctxCPU = document.getElementById('cpuChart').getContext('2d');
        const ctxRAM = document.getElementById('ramChart').getContext('2d');
        const ctxDisk = document.getElementById('diskChart').getContext('2d');

        const charts = {
            cpu: new Chart(ctxCPU, {
                type: 'line',
                data: {
                    labels: chartData.cpu.labels,
                    datasets: [{ label: chartData.cpu.title, data: chartData.cpu.data, borderColor: 'red', borderWidth: 2, fill: false }]
                },
                options: chartOptions
            }),
            ram: new Chart(ctxRAM, {
                type: 'line',
                data: {
                    labels: chartData.ram.labels,
                    datasets: [{ label: chartData.ram.title, data: chartData.ram.data, borderColor: 'blue', borderWidth: 2, fill: false }]
                },
                options: chartOptions
            }),
            disk: new Chart(ctxDisk, {
                type: 'line',
                data: {
                    labels: chartData.disk.labels,
                    datasets: [{ label: chartData.disk.title, data: chartData.disk.data, borderColor: 'orange', borderWidth: 2, fill: false }]
                },
                options: chartOptions
            })
        };

        // Real-time alerts
        function displayAlert(message, type) {
            const alertList = document.getElementById('alertList');
            const listItem = document.createElement('li');
            listItem.textContent = message;
            listItem.classList.add(`alert-${type}`);
            alertList.appendChild(listItem);
        }

        // Simulated data generation (replace with actual data source)
        function generateData(metric) {
            // Simulate metric data (0-100%)
            const newData = Math.floor(Math.random() * 101);
            chartData[metric].data.push(newData);

            // Keep a limited history (e.g., last 10 data points)
            if (chartData[metric].data.length > 10) {
                chartData[metric].data.shift();
                chartData[metric].labels.shift();
            }

            // Add a new label (e.g., timestamp)
            chartData[metric].labels.push(new Date().toLocaleTimeString());

            // Check for threshold alerts
            if (newData > document.getElementById(`${metric}Threshold`).value) {
                displayAlert(`High ${chartData[metric].title} Alert: ${newData}%`, metric);
            }

            // Update the chart
            charts[metric].update();
        }

        // Update the charts every 2 seconds
        setInterval(() => {
            generateData('cpu');
            generateData('ram');
            generateData('disk');
        }, 2000);
    </script>
</body>
</html>
